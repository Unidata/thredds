<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>FeatureDataset API</title>
<style type="text/css">
pre {font-size: 9pt; padding: 10px; background-color: #E7E7E7; border: 1px solid #CFCFCF; width: 85%;}
code {font-size: 11pt;}
dl {margin: 10px 5px 5px 15px;)
.style1 {font-style: italic}
.style1 {font-weight: bold}
</style>
</head>

<body>
<h1>Scientific Feature Types</h1>
<p>A <strong>FeatureDataset</strong> is a container for FeatureType objects. It is a generalization of a NetcdfDataset, and the common case is that it wraps a NetcdfDataset. </p>
<pre>  public interface <strong>ucar.nc2.ft.FeatureDataset</strong>{<br />    ucar.nc2.constants.FeatureType <strong>getFeatureType</strong>();
<br />    String <strong>getTitle</strong>();<br />    String <strong>getDescription</strong>();<br />    String <strong>getLocationURI</strong>();
<br />    ucar.nc2.units.DateRange <strong>getDateRange</strong>();<br />    Date <strong>getStartDate</strong>();<br />    Date <strong>getEndDate</strong>();<br />    ucar.unidata.geoloc.LatLonRect <strong>getBoundingBox</strong>();
<br />    List&lt;Attribute&gt; <strong>getGlobalAttributes</strong>();<br />    ucar.nc2.Attribute <strong>findGlobalAttributeIgnoreCase</strong>(String attName);
<br />    List&lt;VariableSimpleIF&gt; <strong>getDataVariables</strong>();<br />    ucar.nc2.VariableSimpleIF <strong>getDataVariable</strong>(String name);
<br />    void <strong>close</strong>() throws java.io.IOException;
  }
</pre>
<p>  The data variables  are simple versions of Variables, in particular they have no read methods: </p>
<pre>
  public interface <strong>ucar.nc2.VariableSimpleIF</strong> {<br />    String <strong>getName</strong>();<br />    String <strong>getShortName</strong>();<br />    String <strong>getDescription</strong>();<br />    String <strong>getUnitsString</strong>();
<br />    int <strong>getRank</strong>();<br />    int[] <strong>getShape</strong>();<br />    List&lt;Dimension&gt; <strong>getDimensions</strong>();<br />    ucar.ma2.DataType <strong>getDataType</strong>();
<br />    List&lt;Attribute&gt; <strong>getAttributes</strong>();<br />    ucar.nc2.Attribute <strong>findAttributeIgnoreCase</strong>(java.lang.String);<br />  }
</pre>
<p>The information in the FeatureDataset interface constitutes a simple kind of discovery metadata for the dataset. </p>
<h3>FeatureTypes</h3>
<p>A featureType is specified with one of the following enum values:</p>
<pre>
public enum <strong>ucar.nc2.constants.FeatureType</strong> {
<strong>  ANY, // any type 
  NONE, // no type

  GRID,
  RADIAL,
  SWATH,
  IMAGE,

  ANY_POINT, // any of the following
  POINT,
  PROFILE,
  SECTION,
  STATION,
  STATION_PROFILE,
  TRAJECTORY;</strong>
}
  </pre>
<h3>Opening a FeatureDataset </h3>
<p>One gets a FeatureDataset by calling </p>
<pre>  FeatureDataset <strong>FeatureDatasetFactoryManager.open</strong>( FeatureType type, String location, ucar.nc2.util.CancelTask task, java.util.Formatter errlog);
</pre>
<p>  or if you already have an opened NetcdfDataset:</p>
<pre>  FeatureDataset <strong>FeatureDatasetFactoryManager.wrap</strong>( FeatureType type, NetcdfDataset ncd, ucar.nc2.util.CancelTask task, java.util.Formatter errlog);
</pre>
<p>Specifying the FeatureType means that you only want a FeatureDataset of that FeatureType. If you want the dataset opened as any FeatureType, leave the type null or set to FeatureType.<strong>ANY</strong>. You may specify that you want one of the point types with FeatureType.<strong>ANY_POINT</strong>. You may  leave the task null if you do not need to allow user cancelling. The errlog is an instance of java.util.Formatter, and must not be null. If the open() or wrap() is not successful, a null FeatureDataset will be returned, and the errlog will usually have an explanatory message. </p>
<p>The returned object will be a subclass of FeatureDataset, depending on the FeatureType. To get at the data in a FeatureDataset, you must cast it to its subclass, based on the FeatureType. For example: </p>
<pre>

    FeatureDataset fdataset = null;
    try {
      Formatter errlog = new Formatter();
      fdataset = FeatureDatasetFactoryManager.open(wantType, location, null, errlog);
      if (fdataset == null) {
        System.out.printf("**failed on %s %n --> %s %n", location, errlog);
        return;
      }

      FeatureType ftype = fdataset.getFeatureType();
      assert FeatureDatasetFactoryManager.featureTypeOk(wantType, ftype);

      <strong>if (ftype == FeatureType.GRID) {
        assert (fdataset instanceof GridDataset)</strong>;
        GridDataset griddedDataset = (GridDataset) fdataset;
        ...

      } else <strong>if (ftype == FeatureType.RADIAL) {
        assert (fdataset instanceof RadialDatasetSweep)</strong>;
        RadialDatasetSweep radialDataset = (RadialDatasetSweep) fdataset;
        ...

      } else <strong>if (ftype.isPointFeatureType()) {
        assert fdataset instanceof FeatureDatasetPoint;</strong>
        FeatureDatasetPoint pointDataset = (FeatureDatasetPoint) fdataset;
        ...
      }


    } finally {
      if (fdataset != null) fdataset.close();
    }
</pre>
<p>Note that these are the only feature types implemented so far.</p>
<h3>Point FeatureDatasets</h3>
<p>A <strong>FeatureDatasetPoint</strong> simply contains a list of <strong>FeatureCollections</strong>: </p>
<pre>  public interface <strong>ucar.nc2.ft.FeatureDatasetPoint</strong> extends FeatureDataset {<br />     List&lt;FeatureCollection&gt; <strong>getPointFeatureCollectionList</strong>();<br />  }</pre>
<p>All of the specialization is in the subclass of <strong>FeatureCollection</strong>, and you typically cast to process the data: </p>
<pre>
  void process(FeatureDatasetPoint fdpoint) {
    FeatureType ftype = fdpoint.getFeatureType();


    for (FeatureCollection fc : fdpoint.getPointFeatureCollectionList()) {
      assert (ftype == fc.getCollectionFeatureType());
<strong>
      if (ftype == FeatureType.POINT) {
        assert (fc instanceof PointFeatureCollection)</strong>;
        PointFeatureCollection pointCollection = (PointFeatureCollection) fc;
        ...
      } <strong>else if (ftype == FeatureType.STATION) {
        assert (fc instanceof StationTimeSeriesFeatureCollection)</strong>;
        StationTimeSeriesFeatureCollection stationCollection = (StationTimeSeriesFeatureCollection) fc;
        ...
      } <strong>else if (ftype == FeatureType.PROFILE) {
        assert (fc instanceof ProfileFeatureCollection)</strong>;
        ProfileFeatureCollection profileCollection = (ProfileFeatureCollection) fc;
        ...
      } <strong>else if (ftype == FeatureType.STATION_PROFILE) {
        assert (fc instanceof StationProfileFeatureCollection)</strong>;
        StationProfileFeatureCollection stationProfileCollection = (StationProfileFeatureCollection) fc;
<strong>        ...
      } else if (ftype == FeatureType.TRAJECTORY) {
        assert (fc instanceof TrajectoryFeatureCollection);
</strong>        TrajectoryFeatureCollection trajectoryCollection = (TrajectoryFeatureCollection) fc;
        ...
      } else <strong>if (ftype == FeatureType.SECTION) {
        assert (fc instanceof SectionFeatureCollection)</strong>;
        SectionFeatureCollection sectiontCollection = (SectionFeatureCollection) fc;
        ...      
      }
    }
  }</pre>
<h2>Processing Feature Datasets</h2>
<ul>
  <li><a href="PointFeatures.html">Point Dataset </a>: Points, Station Time Series, Profiles, Trajectories and Sections </li>
  <li><a href="../../tutorial/GridDatatype.html">Grid Dataset </a>: data is in a multidimensional grid with seperable coordinates, eg   model output, geosynchronous satellite  data.</li>
  <li><a href="../../tutorial/RadialDatatype.html">Radial Dataset </a>: uses polar coordinates (elevation, azimuth, distance), for example scanning radars, lidars.<br>
  </li>
</ul>
<hr width="100%" />
<address>
<img src="../../nc.gif" width="64" height="64" /> This document is maintained by <a href="mailto:caron@unidata.ucar.edu">John Caron</a> and was last updated on June 16, 2009
</address>
</body>
</html>
