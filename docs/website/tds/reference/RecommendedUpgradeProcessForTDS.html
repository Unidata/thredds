<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
  <title>Recommended Process for Upgrading a THREDDS Data Server (TDS)</title>
  <link href="../tds.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<h1>Recommended Process for Upgrading a TDS</h1>

<p>
  When upgrading a THREDDS Data Server (TDS), it is important to fully undeploy the running TDS
  before deploying the new TDS. Not doing so can cause conflicts between old and new Java classes
  and/or JSP pages (among other things). The reason for this is that Tomcat and other webapp
  containers have working directories [<a href="#noteWorkDir">1</a>] of some kind in which to
  keep files they need (like compiled JSP pages).
</p>

<p>
  So, here is the process we follow when we upgrade the TDS on our systems (we use Tomcat,
  but the process should be similar for other webapp containers):
</p>
<ol>
  <li>Use the Tomcat manager app [<a href="#noteManagerUrl">2</a>] to undeploy the TDS</li>
  <li>Shutdown Tomcat [<a href="#noteStopStart">3</a>]</li>
  <li>Clean up any log files [<a href="#noteLogCleanup">4</a>]</li>
  <li>Startup Tomcat</li>
  <li>Use the Tomcat manager to deploy the new TDS</li>
</ol>

<hr>
<h2>Notes</h2>
<ol>
  <li><a name="noteWorkDir"></a>work/Catalina/localhost/thredds</li>
  <li><a name="noteManagerUrl"></a>https://server:port/manager/html/</li>
  <li><a name="noteStopStart"></a>
    One reason to stop-and-restart Tomcat, besides cleaning up log files (some of which Tomcat
  keeps open), is to avoid the PermGen memory error mentioned <a href="../tutorial/BasicTomcatAndTDSSecurity.html">here</a>  </li>
  <li><a name="noteLogCleanup"></a> The Tomcat and TDS log files we clean up when upgrading:
    <ul>
      <li>In <samp>${TOMCAT_HOME}/logs</samp>/*      </li>
      <li>In <samp>${TOMCAT_HOME}/content/thredds/logs</samp>/*      </li>
    </ul>
    Where <samp>${TOMCAT_HOME}</samp> is the directory in which Tomcat is installed.
  </li>
</ol>

<hr width="100%">
<address>
  <img src="../thredds-tds_64.png" alt="THREDDS" >
  This document is maintained by Unidata. Send comments to
  <a href="mailto:support-thredds@unidata.ucar.edu">THREDDS support</a>.
</address>
<script src="https://docs.unidata.ucar.edu/js/tds46_add_in.js" type="text/javascript"></script>
</body>
</html>
